{"version":3,"file":"styler.cjs.js","sources":["../src/react-css-styler/utils.ts","../src/react-css-styler/styled.tsx"],"sourcesContent":["import stringHash from \"string-hash\";\nimport { splitComma } from \"@daybrush/utils\";\n\nexport function getHash(str: string) {\n  return stringHash(str).toString(36);\n}\nexport function injectStyle(className: string, css: string) {\n  const style = document.createElement(\"style\");\n\n  style.setAttribute(\"type\", \"text/css\");\n  style.innerHTML = css.replace(/([^}{]*){/mg, (all, selector) => {\n    return splitComma(selector).map(subSelector => {\n      if (subSelector.indexOf(\":global\") > -1) {\n        return subSelector.replace(/\\:global/g, \"\");\n      } else if (subSelector.indexOf(\":host\") > -1) {\n        return `${subSelector.replace(/\\:host/g, `.${className}`)}`;\n      }\n      return `.${className} ${subSelector}`;\n    }).join(\", \") + \"{\";\n  });\n\n  (document.head || document.body).appendChild(style);\n  return style;\n}","import { Component, createElement } from \"react\";\nimport { findDOMNode } from \"react-dom\";\nimport { getHash, injectStyle } from \"./utils\";\nimport { StylerElement } from \"./types\";\n\nexport default function styled<T extends keyof JSX.IntrinsicElements = \"div\">(Tag: T, css: string) {\n  const injectClassName = \"rCS\" + getHash(css);\n  let injectCount = 0;\n  let injectElement!: HTMLStyleElement;\n\n  return class Styler extends Component<{\n    [key: string]: any,\n  }> {\n    public element!: StylerElement<T>;\n    constructor(props: any) {\n      super(props);\n    }\n    public render() {\n      const {\n        className,\n        ...attributes\n      } = this.props;\n\n      return createElement(Tag, {\n        className: `${className} ${injectClassName}`,\n        ...attributes,\n      });\n    }\n    public componentDidMount() {\n      if (injectCount === 0) {\n        injectElement = injectStyle(injectClassName, css);\n      }\n      ++injectCount;\n    }\n    public componentWillUnmount() {\n      --injectCount;\n\n      if (injectCount === 0 && injectElement) {\n        injectElement.parentNode!.removeChild(injectElement);\n      }\n    }\n    public getElement() {\n      return this.element || (this.element = findDOMNode(this) as StylerElement<T>);\n    }\n  }\n}"],"names":["getHash","str","stringHash","toString","injectStyle","className","css","style","document","createElement","setAttribute","innerHTML","replace","all","selector","splitComma","map","subSelector","indexOf","join","head","body","appendChild","styled","Tag","injectClassName","injectCount","injectElement","tslib_1","props","_super","Styler","_a","attributes","parentNode","removeChild","element","findDOMNode","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAGgBA,QAAQC;SACfC,UAAU,CAACD,GAAD,CAAV,CAAgBE,QAAhB,CAAyB,EAAzB,CAAP;;AAEF,SAAgBC,YAAYC,WAAmBC;MACvCC,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAd;EAEAF,KAAK,CAACG,YAAN,CAAmB,MAAnB,EAA2B,UAA3B;EACAH,KAAK,CAACI,SAAN,GAAkBL,GAAG,CAACM,OAAJ,CAAY,aAAZ,EAA2B,UAACC,GAAD,EAAMC,QAAN;WACpCC,gBAAU,CAACD,QAAD,CAAV,CAAqBE,GAArB,CAAyB,UAAAC,WAAA;UAC1BA,WAAW,CAACC,OAAZ,CAAoB,SAApB,IAAiC,CAAC,CAAtC,EAAyC;eAChCD,WAAW,CAACL,OAAZ,CAAoB,WAApB,EAAiC,EAAjC,CAAP;OADF,MAEO,IAAIK,WAAW,CAACC,OAAZ,CAAoB,OAApB,IAA+B,CAAC,CAApC,EAAuC;eACrC,KAAGD,WAAW,CAACL,OAAZ,CAAoB,SAApB,EAA+B,MAAIP,SAAnC,CAAV;;;aAEK,MAAIA,SAAJ,MAAA,GAAiBY,WAAxB;KANK,EAOJE,IAPI,CAOC,IAPD,IAOS,GAPhB;GADgB,CAAlB;GAWCX,QAAQ,CAACY,IAAT,IAAiBZ,QAAQ,CAACa,IAA3B,EAAiCC,WAAjC,CAA6Cf,KAA7C;SACOA,KAAP;;;SCjBsBgB,OAAsDC,KAAQlB;MAC9EmB,eAAe,GAAG,QAAQzB,OAAO,CAACM,GAAD,CAAvC;MACIoB,WAAW,GAAG,CAAlB;MACIC,aAAJ;;;;MAE4BC,SAAA,OAAA,QAAA;;qBAI1B,CAAYC,KAAZ;eACEC,WAAA,KAAA,EAAMD,KAAN;;;MAEKE,gBAAA,OAAA,GAAP;YACQC,eAAN;YACE3B,wBADF;YAEE4B,sCAFF;;eAKOxB,mBAAa,CAACe,GAAD;UAClBnB,SAAS,EAAKA,SAAS,MAAT,GAAaoB;WACxBQ,WAFe,CAApB;OANK;;MAWAF,gBAAA,kBAAA,GAAP;YACML,WAAW,KAAK,CAApB,EAAuB;UACrBC,aAAa,GAAGvB,WAAW,CAACqB,eAAD,EAAkBnB,GAAlB,CAA3B;;;UAEAoB,WAAF;OAJK;;MAMAK,gBAAA,qBAAA,GAAP;UACIL,WAAF;;YAEIA,WAAW,KAAK,CAAhB,IAAqBC,aAAzB,EAAwC;UACtCA,aAAa,CAACO,UAAd,CAA0BC,WAA1B,CAAsCR,aAAtC;;OAJG;;MAOAI,gBAAA,WAAA,GAAP;eACS,KAAKK,OAAL,KAAiB,KAAKA,OAAL,GAAeC,oBAAW,CAAC,IAAD,CAA3C,CAAP;OADK;;mBAGT;MAlC4BC;;;;;;"}